<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ì¦ê±°ìš´ í•™êµ ë·”í˜ â€¢ Standalone</title>
    <!-- Tailwind (CDN) â†’ ì¸í„°ë„· ì—°ê²° í•„ìš” -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React 18 & ReactDOM 18 (UMD, CDN) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel (ë¸Œë¼ìš°ì €ì—ì„œ JSX ë³€í™˜) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel" data-presets="env,react">
      // ì¦ê±°ìš´ í•™êµ ë·”í˜ (React 18, CDN) â€” ë‹¨ì¼ HTMLì—ì„œ ì‹¤í–‰
      const { useMemo, useState } = React;

      const DISHES = [
        { id: "pork-belly", name: "ì‚¼ê²¹ì‚´ êµ¬ì´", category: "ì§í™”/êµ¬ì´", factor: 120, emoji: "ğŸ–" },
        { id: "steak", name: "ìŠ¤í…Œì´í¬ êµ½ê¸°", category: "ì§í™”/êµ¬ì´", factor: 120, emoji: "ğŸ¥©" },
        { id: "fish", name: "ìƒì„  êµ¬ì´", category: "ì§í™”/êµ¬ì´", factor: 120, emoji: "ğŸŸ"}, 
        { id: "fried-chicken", name: "ì¹˜í‚¨", category: "íŠ€ê¹€", factor: 120, emoji: "ğŸ—" },
        { id: "fried-shrimp", name: "ìƒˆìš°íŠ€ê¹€", category: "íŠ€ê¹€", factor: 100, emoji: "ğŸ¤" },
        { id: "stirfried-rice", name: "ë³¶ìŒë°¥", category: "ë³¶ìŒ", factor: 110, emoji: "ğŸš" },
        { id: "ramen", name: "ë¼ë©´", category: "ë“ì´ê¸°", factor: 50, emoji: "ğŸœ" },
        { id: "soup", name: "ë§‘ì€êµ­/ìˆ˜í”„", category: "ë“ì´ê¸°", factor: 50, emoji: "ğŸ¥£" },
        { id: "stew", name: "ì°Œê°œ", category: "ë“ì´ê¸°", factor: 50, emoji: "ğŸ²" },
        { id: "curry", name: "ì¹´ë ˆ", category: "ë“ì´ê¸°", factor: 50, emoji: "ğŸ›" },
        { id: "braised spicy chicken", name: "ë‹­ë³¶ìŒíƒ•", category: "ë“ì´ê¸°", factor: 50, emoji: "ğŸ«•" },
        { id: "pizza", name: "í”¼ì", category: "ì˜¤ë¸/êµ¬ì´", factor: 90, emoji: "ğŸ•" },
        { id: "burger", name: "ë²„ê±°", category: "íŒ¨ìŠ¤íŠ¸í‘¸ë“œ", factor: 90, emoji: "ğŸ”" },
        { id: "hotdog", name: "í•«ë„ê·¸", category: "íŒ¨ìŠ¤íŠ¸í‘¸ë“œ", factor: 90, emoji: "ğŸŒ­" },
        { id: "boiled-veggies", name: "ë°ì¹œ ì•¼ì±„", category: "ë°ì¹¨", factor: 5, emoji: "ğŸ¥¬" },
        { id: "icecream", name: "ì•„ì´ìŠ¤í¬ë¦¼", category: "ë””ì €íŠ¸", factor: 5, emoji: "ğŸ¨" },
        { id: "cake", name: "ì¼€ì´í¬", category: "ë””ì €íŠ¸", factor: 5, emoji: "ğŸ°" },
        { id: "yogurt", name: "ìš”í”Œë ˆ", category: "ë””ì €íŠ¸", factor: 5, emoji: "ğŸ¥›" },
        { id: "bubbletea", name: "ë²„ë¸”í‹°", category: "ë””ì €íŠ¸", factor: 5, emoji: "ğŸ§‹" },
        { id: "fruit", name: "ê³¼ì¼", category: "ë””ì €íŠ¸", factor: 5, emoji: "ğŸ‰" },
        { id: "beer", name: "ë§¥ì£¼", category: "ë””ì €íŠ¸", factor: 0, emoji: "ğŸº" },
        { id: "salad", name: "ìƒëŸ¬ë“œ", category: "ìƒì‹", factor: 5, emoji: "ğŸ¥—" },
        { id: "sushi", name: "ì´ˆë°¥", category: "ìƒì‹", factor: 5, emoji: "ğŸ£" },
        { id: "vegetable", name: "ì˜¤ì´", category: "ìƒì‹", factor: 5, emoji: "ğŸ¥’" },
        { id: "apple", name: "ì‚¬ê³¼", category: "ìƒì‹", factor: 5, emoji: "ğŸ" },
        { id: "kimchi", name: "ê¹€ì¹˜", category: "ìƒì‹", factor: 5, emoji: "ğŸŒ¶ï¸ğŸ§„ğŸ¥¬" }
      ];

      const GAME_OVER_THRESHOLD = 300; // ê¶Œê³  ì„ê³„ê°’(ì´ì œëŠ” ê²Œì„ ì¢…ë£Œê°€ ì•„ë‹˜)
      const TRAY_SLOTS = 5; // ìœ„ 3ì¹¸ + ì•„ë˜ 2ì¹¸

      function levelFromScore(score) {
        if (score >= 350) return { label: "ë§¤ìš° ë†’ìŒ", desc: "í™˜ê¸° ìµœìš°ì„ !", emoji: "ğŸ”¥" };
        if (score >= 250) return { label: "ë†’ìŒ", desc: "ê°•ì œ í™˜ê¸° í•„ìš”", emoji: "âš ï¸" };
        if (score >= 150) return { label: "ë³´í†µ", desc: "ê°„í— í™˜ê¸° ê¶Œì¥", emoji: "ğŸŸ¡" };
        return { label: "ë‚®ìŒ", desc: "ì–‘í˜¸í•œ ìƒíƒœ", emoji: "ğŸŸ¢" };
      }

      function endingFromScore(score) {
        if (score <= 150) return { title: "ì¡°ë¦¬í„ ì ì€ ì‹ë‹¨! ì°¸ ì˜í–ˆì–´ìš” ğŸ™Œ", detail: "í™˜ê¸° ë¶€ë‹´ì´ ì ì–´ìš”. ì´ëŸ° ì‹ë‹¨, ê³„ì† ìœ ì§€í•´ë³¼ê¹Œìš”?" };
        if (score <= 250) return { title: "ë¬´ë‚œë¬´ë‚œ ì‹ë‹¨ ğŸ˜Œ", detail: "í™˜ê¸°ê°€ ê°€ë” í•„ìš”í•´ìš”. ë‹¤ìŒì—” ë” ê°€ë²¼ìš´ ë©”ë‰´ë„ ë„ì „!" };
        if (score <= 350) return { title: "ë³´í†µ ìˆ˜ì¤€ ğŸŸ¡", detail: "ì¡°ë¦¬í„ì´ ìŒ“ì˜€ì–´ìš”. ì‹ì‚¬ í›„ í™˜ê¸°ë¥¼ í•œë²ˆ ëŒë ¤ìš”." };
        if (score <= 600) return { title: "ì¡°ë¦¬ì‚¬ë‹˜ì€ ì½œë¡ì½œë¡â€¦ ğŸ˜·", detail: "ê°•í•œ ì—´Â·ê¸°ë¦„ ì¡°ë¦¬ê°€ ë§ì•˜ë„¤ìš”. ê°•ì œ í™˜ê¸° ê¶Œì¥!" };
        return { title: "ì—°ê¸° í­ë°œ! ğŸ”¥", detail: "ì¦‰ì‹œ í™˜ê¸°, ì¡°ë¦¬ ë°©ì‹ ì¡°ì ˆì´ í•„ìš”í•´ìš”." };
      }

      function BuffetFumeGame() {
        const [slots, setSlots] = useState(Array(TRAY_SLOTS).fill(null));
        const [search, setSearch] = useState("");

        const totalScore = useMemo(
          () => slots.reduce((sum, item) => sum + (item?.factor ?? 0), 0),
          [slots]
        );
        const level = levelFromScore(totalScore);

        const isComplete = useMemo(() => slots.every((s) => s != null), [slots]);

        const addDish = (dish) => {
          if (isComplete) return; // ë‹¤ ì°¼ìœ¼ë©´ ë¬´ì‹œ
          const idx = slots.findIndex((s) => s == null);
          if (idx === -1) return; // ë¹ˆ ì¹¸ ì—†ìŒ
          const next = [...slots];
          next[idx] = dish;
          setSlots(next);
        };

        const resetAll = () => {
          setSlots(Array(TRAY_SLOTS).fill(null));
        };

        const filtered = useMemo(() => {
          const q = (search || "").trim().toLowerCase();
          if (!q) return DISHES;
          return DISHES.filter((d) =>
            (d.name || "").toLowerCase().includes(q) || (d.category || "").toLowerCase().includes(q)
          );
        }, [search]);

        const dishColor = (dish) => {
          if (!dish) return "#f8fafc";
          const cat = dish.category || "";
          if (cat.includes("íŠ€ê¹€")) return "#ffffff";
          if (cat.includes("êµ¬ì´")) return "#ffffff";
          if (cat.includes("ë“ì´ê¸°")) return "#ffffff";
          if (cat.includes("ë°ì¹¨")) return "#ffffff";
          if (cat.includes("íŒ¨ìŠ¤íŠ¸í‘¸ë“œ")) return "#ffffff";
          if (cat.includes("ë””ì €íŠ¸")) return "#ffffff";
          if (cat.includes("ìƒì‹")) return "#ffffff";
          return "#ffffff";
        };

        return (
          <div className="min-h-[90vh] w-full p-6 sm:p-8 bg-gradient-to-b from-white to-slate-50 text-slate-800">
            {/* í—¤ë” */}
            <div className="max-w-5xl mx-auto">
              <h1 className="text-2xl sm:text-3xl font-semibold tracking-tight">ì¦ê±°ìš´ í•™êµ ë·”í˜ ğŸ½ï¸</h1>
              <p className="mt-1 text-sm text-slate-600">ìŒì‹ì„ ì„ íƒí•˜ë©´ ê¸‰ì‹íŒì— ë‹´ê²¨ìš”.</p>
            </div>

            {/* ìš”ì•½ ì¹´ë“œ */}
            <div className="max-w-5xl mx-auto mt-5 grid gap-4 sm:grid-cols-3">
              <div className="col-span-2 bg-white rounded-2xl shadow p-5">
                <div className="flex items-baseline justify-between">
                  <div>
                    <div className="text-sm text-slate-500">ì´ ì¡°ë¦¬í„ ì ìˆ˜</div>
                    <div className="text-3xl font-bold tabular-nums">{totalScore}</div>
                  </div>
                  <button onClick={resetAll} className="px-3 py-2 rounded-xl bg-slate-100 hover:bg-slate-200 text-sm">ì´ˆê¸°í™”</button>
                </div>
                <div className="mt-4">
                  <div className="h-3 w-full rounded-full bg-slate-100 overflow-hidden">
                    <div
                      className="h-3 rounded-full transition-all"
                      style={{
                        width: `${Math.min(100, (totalScore / GAME_OVER_THRESHOLD) * 100)}%`,
                        background:
                          totalScore >= GAME_OVER_THRESHOLD
                            ? "#ef4444"
                            : totalScore >= 250
                            ? "#f59e0b"
                            : totalScore >= 120
                            ? "#eab308"
                            : "#22c55e",
                      }}
                    />
                  </div>
                  <div className="mt-2 text-sm text-slate-600 flex items-center gap-2">
                    <span className="text-base">{level.emoji}</span>
                    <span className="font-medium">{level.label}</span>
                    <span className="text-slate-400">Â·</span>
                    <span>{level.desc}</span>
                  </div>
                  <div className="mt-1 text-xs text-slate-500">ê¶Œê³  ì„ê³„ê°’: <span className="font-semibold tabular-nums">{GAME_OVER_THRESHOLD}</span>ì  ì´ˆê³¼ ì‹œ ì£¼ì˜</div>
                </div>
              </div>
              <div className="bg-white rounded-2xl shadow p-5 flex flex-col">
                <label className="text-xs text-slate-500">ë©”ë‰´ ê²€ìƒ‰</label>
                <input
                  className="mt-1 rounded-xl border border-slate-200 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-slate-300"
                  placeholder="ì˜ˆ: íŠ€ê¹€, êµ¬ì´, ìƒëŸ¬ë“œ"
                  value={search}
                  onChange={(e) => setSearch(e.target.value)}
                />
              </div>
            </div>

            {/* ì‹íŒ UI (ìœ„ 3ì¹¸, ì•„ë˜ 2ì¹¸) */}
            <div className="max-w-5xl mx-auto mt-6 flex flex-col items-center">
              <div className="relative w-[400px] h-[300px] bg-gray-300 rounded-xl grid grid-cols-6 gap-2 p-2">
                {/* ìœ„ 3ì¹¸ */}
                {[0,1,2].map((i) => {
                  const dish = slots[i];
                  return (
                    <div key={`top-${i}`} className="col-span-2 flex items-center justify-center bg-gray-100 rounded-lg relative">
                      {dish && (
                        <>
                          <svg width="56" height="56" viewBox="0 0 56 56" aria-label={dish.name}>
                            <circle cx="28" cy="28" r="22" fill={dishColor(dish)} />
                            <rect x="18" y="18" width="20" height="20" rx="6" fill="white" opacity="0.6" />
                          </svg>
                          <span className="absolute text-2xl" aria-hidden>{dish.emoji}</span>
                        </>
                      )}
                    </div>
                  );
                })}

                {/* ì•„ë˜ 2ì¹¸ */}
                {[3,4].map((i) => {
                  const dish = slots[i];
                  return (
                    <div key={`bottom-${i}`} className="col-span-3 flex items-center justify-center bg-gray-100 rounded-lg relative">
                      {dish && (
                        <>
                          <svg width="56" height="56" viewBox="0 0 56 56" aria-label={dish.name}>
                            <circle cx="28" cy="28" r="22" fill={dishColor(dish)} />
                            <rect x="18" y="18" width="20" height="20" rx="6" fill="white" opacity="0.6" />
                          </svg>
                          <span className="absolute text-2xl" aria-hidden>{dish.emoji}</span>
                        </>
                      )}
                    </div>
                  );
                })}
              </div>
              <div className="mt-2 text-xs text-slate-500">ìŒì‹ì„ ë‹´ìœ¼ë©´ ì‹íŒ ì¹¸ì´ ì±„ì›Œì§‘ë‹ˆë‹¤. 5ê°œ ëª¨ë‘ ì±„ìš°ë©´ ê²°ê³¼ í™”ë©´ì´ ëœ¹ë‹ˆë‹¤.</div>
            </div>

            {/* ìŒì‹ ì„ íƒ ëª©ë¡ */}
            <div className="max-w-5xl mx-auto mt-8 grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
              {filtered.map((d) => (
                <div key={d.id} className="bg-white rounded-2xl shadow p-5 flex flex-col justify-between">
                  <div className="flex items-start justify-between gap-3">
                    <div>
                      <div className="text-lg font-semibold">{d.name}</div>
                      <div className="text-xs text-slate-500 mt-0.5">{d.category}</div>
                      <div className="mt-3 text-sm text-slate-600">ê°€ì¤‘ì¹˜: <span className="font-medium tabular-nums">{d.factor}</span></div>
                    </div>
                    <div className="w-12 h-12 rounded-xl bg-slate-50 border border-slate-100 flex items-center justify-center relative">
                      <svg width="32" height="32" viewBox="0 0 56 56">
                        <circle cx="28" cy="28" r="22" fill={dishColor(d)} />
                        <rect x="18" y="18" width="20" height="20" rx="6" fill="white" opacity="0.6" />
                      </svg>
                      <span className="absolute text-lg" aria-hidden>{d.emoji}</span>
                    </div>
                  </div>
                  <div className="mt-4 flex items-center justify-end">
                    <button
                      onClick={() => addDish(d)}
                      disabled={isComplete}
                      className={`px-4 py-2 rounded-xl text-sm font-semibold ${isComplete ? 'bg-slate-300 cursor-not-allowed' : 'bg-slate-900 hover:bg-slate-800 text-white'}`}
                    >
                      ë‹´ê¸°
                    </button>
                  </div>
                </div>
              ))}
            </div>

            {/* ê²°ê³¼ ëª¨ë‹¬ (5ì¹¸ ëª¨ë‘ ì°¼ì„ ë•Œ) */}
            {isComplete && (
              <div className="fixed inset-0 z-50 bg-black/40 backdrop-blur-sm flex items-center justify-center">
                <div className="bg-white rounded-2xl shadow-xl p-6 w-[min(92vw,520px)] text-center">
                  {(() => { const ending = endingFromScore(totalScore); return (
                    <>
                      <div className="text-2xl sm:text-3xl font-bold">ğŸ¯ ê²°ê³¼</div>
                      <div className="mt-2 text-slate-600">
                        ì´ ì¡°ë¦¬í„ ì ìˆ˜ <span className="font-bold tabular-nums">{totalScore}</span>ì 
                      </div>
                      <div className="mt-4">
                        <div className="text-lg font-semibold">{ending.title}</div>
                        <div className="mt-1 text-sm text-slate-600">{ending.detail}</div>
                      </div>
                      <div className="mt-5 grid grid-cols-2 gap-3">
                        <button onClick={resetAll} className="px-4 py-2 rounded-xl bg-slate-900 text-white hover:bg-slate-800">ë‹¤ì‹œ ë„ì „í•˜ê¸°</button>
                        <a href="https://euten11.wixsite.com/my-site-3" target="_blank" rel="noreferrer" className="px-4 py-2 rounded-xl bg-slate-100 hover:bg-slate-200 inline-flex items-center justify-center">ê¸°ì‚¬ ë³´ëŸ¬ê°€ê¸°</a>
                      </div>
                    </>
                  ); })()}
                </div>
              </div>
            )}

            {/* ì•ˆë‚´ë¬¸ */}
            <div className="max-w-5xl mx-auto mt-8 text-xs text-slate-500 leading-relaxed">
              * ë³¸ ê²Œì„ì˜ ì¡°ë¦¬í„ ì ìˆ˜ëŠ” ë°ëª¨ìš© ì¶”ì • ê°€ì¤‘ì¹˜ì…ë‹ˆë‹¤. ë©”ë‰´/ì¡°ë¦¬ë°©ì‹/ê¸°ê¸° ì„±ëŠ¥, í™˜ê¸° ìƒíƒœì— ë”°ë¼ ì‹¤ì œ ìˆ˜ì¹˜ëŠ” ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </div>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<BuffetFumeGame />);
    </script>
  </body>
</html>
